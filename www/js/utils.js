function setUpPanels() { loadSettings(); var e = document.getElementsByTagName(PANEL_HEADING_TAG); for (var t = 0; t < e.length; t++) { var n = e[t]; if (n.parentNode.className != PANEL_NORMAL_CLASS && n.parentNode.className != PANEL_COLLAPSED_CLASS) continue; var r = n.firstChild.nodeValue; if (panelsStatus[r] == "false") n.parentNode.className = PANEL_COLLAPSED_CLASS; else if (panelsStatus[r] == "true") { n.parentNode.className = PANEL_NORMAL_CLASS } else { panelsStatus[r] = n.parentNode.className == PANEL_NORMAL_CLASS ? "true" : "false" } n.onclick = function () { var e = this.parentNode; var t = this.firstChild.nodeValue; var n = e.className == PANEL_COLLAPSED_CLASS; saveSettings(t, n ? "true" : "false"); animateTogglePanel(e, n) } } } function animateTogglePanel(e, t) { var n = e.getElementsByTagName("div"); var r = null; for (var i = 0; i < n.length; i++) { if (n[i].className == PANEL_CONTENT_CLASS) { r = n[i]; break } } r.style.display = "block"; var s = r.offsetHeight; if (t) r.style.height = "0px"; var o = s / PANEL_ANIMATION_STEPS; var u = !t ? -1 : 1; setTimeout(function () { animateStep(r, 1, o, u) }, PANEL_ANIMATION_DELAY) } function animateStep(e, t, n, r) { if (t < PANEL_ANIMATION_STEPS) { e.style.height = Math.round((r > 0 ? t : 10 - t) * n) + "px"; t++; setTimeout(function () { animateStep(e, t, n, r) }, PANEL_ANIMATION_DELAY) } else { e.parentNode.className = r < 0 ? PANEL_COLLAPSED_CLASS : PANEL_NORMAL_CLASS; e.style.display = e.style.height = "" } } function loadSettings() { panelsStatus = {}; var e = document.cookie.indexOf(PANEL_COOKIE_NAME + "="); if (e == -1) return; e += PANEL_COOKIE_NAME.length + 1; var t = document.cookie.indexOf(";", e); if (t == -1) t = document.cookie.length; var n = unescape(document.cookie.substring(e, t)); n = n.replace("null:true", "null:false"); var r = n.split("|"); for (var i = 0; i < r.length; i++) { var s = r[i].split(":"); panelsStatus[s[0]] = s[1] } } function expandAll() { for (var e in panelsStatus) saveSettings(e, "true"); setUpPanels() } function collapseAll() { for (var e in panelsStatus) saveSettings(e, "false"); setUpPanels() } function saveSettings(e, t) { panelsStatus[e] = t; var n = []; for (var e in panelsStatus) n.push(e + ":" + panelsStatus[e]); var r = new Date; var i = new Date(r.getTime() + 365 * 1e3 * 60 * 60 * 24); document.cookie = PANEL_COOKIE_NAME + "=" + escape(n.join("|")) + ";expires=" + i.toGMTString() } var PANEL_NORMAL_CLASS = "panel"; var PANEL_COLLAPSED_CLASS = "panelcollapsed"; var PANEL_HEADING_TAG = "h2"; var PANEL_CONTENT_CLASS = "panelcontent"; var PANEL_COOKIE_NAME = "panels"; var PANEL_ANIMATION_DELAY = 20; var PANEL_ANIMATION_STEPS = 10; if (window.addEventListener) { window.addEventListener("load", setUpPanels, false) } else if (window.attachEvent) { window.attachEvent("onload", setUpPanels) }